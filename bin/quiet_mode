#!/usr/bin/env bash
set -Eeuo pipefail

source "${HOME}/environment/lib/helpers.bash"

# --------------------------------------------------
# Quiet mode - toggle notifications
# Disable/Enable notifications with status icon
# --------------------------------------------------

readonly QUIET_MODE_ICON="${HOME}/environment/assets/nonotif.png"

command -v dunstctl >/dev/null || die "dunstctl not found"
command -v yad >/dev/null || die "yad not found"

dunstctl set-paused toggle

if [[ "$(dunstctl is-paused)" == "true" ]]; then
    bash -c "exec -a quiet_mode_icon yad --notification --image='${QUIET_MODE_ICON}' --listen --text='Quiet mode on' --no-middle &"
else
    pkill -f quiet_mode_icon || true
fi
