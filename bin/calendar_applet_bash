#!/bin/bash

clear
ncal -bwM
current_date=$(date "+%Y-%m-%d")

while read -srn1 key; do
    action=""
    if [[ $key == "h" ]]; then
        action="-1 day"
    fi
    if [[ $key == "l" ]]; then
        action="+1 day"
    fi
    if [[ $key == "j" ]]; then
        action="+1 week"
    fi
    if [[ $key == "k" ]]; then
        action="-1 week"
    fi
    if [[ $key == "u" ]]; then
        action="-1 month"
        current_date="$(date --date="$current_date" "+%Y-%m")-15"
    fi
    if [[ $key == "o" ]]; then
        action="+1 month"
        current_date="$(date --date="$current_date" "+%Y-%m")-15"
    fi
    if [[ $key == "q" ]]; then
        break
    fi
    if [[ -n $action ]]; then
        clear
        current_date=$(date --date="$current_date $action" "+%Y-%m-%d")
        ncal -bwMH "$current_date" -d "$(date --date="$current_date" "+%Y-%m")"
    fi
done
