#!/bin/bash
# Open web apps only if there's not another instance of that web app.
# The web apps are opened in workspace 4 tabbed and are managed with i3.

web_apps=(
    https://web.whatsapp.com/
    https://www.instagram.com/
    https://discord.com/channels/@me
    https://mail.google.com/mail/u/0/#inbox
    https://web.skype.com/
    https://trello.com/
    https://web.telegram.org/a/
)

chrome_window_ids=$(xdotool search --class "Google-chrome")
instances=()
for id in $chrome_window_ids; do
    instance_name=$(xprop -id "$id" | grep WM_CLASS | awk '{ print $3 }')
    instances+=("$instance_name")
done
for app in "${web_apps[@]}"; do
    instance_name=$(echo "$app" | sed -r 's/^https:\/\/([a-zA-Z.]+).*/\1/')
    if [[ ${instances[@]} =~ $instance_name ]]; then continue; fi
        chrome --app="$app"
    sleep 1
done
